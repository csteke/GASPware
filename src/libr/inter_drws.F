CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C$+									C
C			DISEGNO SEMPLIFICATO SPETTRI			C
C$-									C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

	SUBROUTINE DRAW_ISPEC(ISPEC,NCHAN,IX0,IX1,IY0,IY1,IROT,EXPY)

	INTEGER*2 ISPEC(0:1)
	INTEGER*2 MAXY

	logical*1 ROT,HIST

	ROT=IROT.NE.0

	ITX0=IX0
	ITX1=IX1
	ITY0=IY0
	ITY1=IY1
	ITXMIN=MIN(ITX0,ITX1)
	ITXMAX=MAX(ITX0,ITX1)
	ITYMIN=MIN(ITY0,ITY1)
	ITYMAX=MAX(ITY0,ITY1)

	CALL MOVABS(ITX0,ITY0)
	CALL DRWABS(ITX1,ITY0)
	CALL DRWABS(ITX1,ITY1)
	CALL DRWABS(ITX0,ITY1)
	CALL DRWABS(ITX0,ITY0)

	MAXY=0
	DO II=0,NCHAN-1
		MAXY=MAX(MAXY,ISPEC(II))
	ENDDO
	IF(MAXY.EQ.0) MAXY=1

	IF(ROT) THEN
	   IUX0=0
	   IUX1=MAXY
	   IUY0=0
	   IUY1=NCHAN-1
	ELSE
	   IUX0=0
	   IUX1=NCHAN-1
	   IUY0=0
	   IUY1=MAXY
	ENDIF

	XSCA=FLOAT(ITX1-ITX0+1) / FLOAT(IUX1-IUX0+1)
	YSCA=FLOAT(ITY1-ITY0+1) / FLOAT(IUY1-IUY0+1)

	IF(ROT) THEN
	   IF(EXPY.NE.0) XSCA=XSCA*EXPY
	   HIST=ABS(YSCA).GT.1.0
	ELSE
	   IF(EXPY.NE.0) YSCA=YSCA*EXPY
	   HIST=ABS(XSCA).GT.1.0
	ENDIF

	CALL MOVABS(ITX0,ITY0)
	IF(ROT) THEN
	   DO II=0,NCHAN-1
		IUX=ISPEC(II)
		IUY=II
		IX=ITX0 + (IUX-IUX0)*XSCA
		IF(IX.LT.ITXMIN) IX=ITXMIN
		IF(IX.GT.ITXMAX) IX=ITXMAX
		IF(HIST) THEN
		   IY=ITY0 + ((IUY-1)-IUY0)*YSCA
		   IF(IY.LT.ITYMIN) IY=ITYMIN
		   IF(IY.GT.ITYMAX) IY=ITYMAX
		   CALL DRWABS( IX, IY)
		ENDIF
		IY=ITY0 + (IUY-IUY0)*YSCA
		IF(IY.LT.ITYMIN) IY=ITYMIN
		IF(IY.GT.ITYMAX) IY=ITYMAX
		CALL DRWABS( IX, IY)
	   ENDDO
	ELSE
	   DO II=0,NCHAN-1
		IUX=II
		IUY=ISPEC(II)
		IY=ITY0 + (IUY-IUY0)*YSCA
		IF(IY.LT.ITYMIN) IY=ITYMIN
		IF(IY.GT.ITYMAX) IY=ITYMAX
		IF(HIST) THEN
		   IX=ITX0 + ((IUX-1)-IUX0)*XSCA
		   IF(IX.LT.ITXMIN) IX=ITXMIN
		   IF(IX.GT.ITXMAX) IX=ITXMAX
		   CALL DRWABS( IX, IY)
		ENDIF
		IX=ITX0 + (IUX-IUX0)*XSCA
		IF(IX.LT.ITXMIN) IX=ITXMIN
		IF(IX.GT.ITXMAX) IX=ITXMAX
		CALL DRWABS( IX, IY)
	   ENDDO
	ENDIF
	CALL MOVABS(ITX0,ITY0)

	RETURN

	END

	SUBROUTINE DRAW_LSPEC(LSPEC,NCHAN,IX0,IX1,IY0,IY1,IROT,EXPY)

	INTEGER LSPEC(0:1)

	logical*1 ROT,HIST

	ROT=IROT.NE.0

	ITX0=IX0
	ITX1=IX1
	ITY0=IY0
	ITY1=IY1
	ITXMIN=MIN(ITX0,ITX1)
	ITXMAX=MAX(ITX0,ITX1)
	ITYMIN=MIN(ITY0,ITY1)
	ITYMAX=MAX(ITY0,ITY1)

	CALL MOVABS(ITX0,ITY0)
	CALL DRWABS(ITX1,ITY0)
	CALL DRWABS(ITX1,ITY1)
	CALL DRWABS(ITX0,ITY1)
	CALL DRWABS(ITX0,ITY0)

	MAXY=0
	DO II=0,NCHAN-1
		MAXY=MAX(MAXY,LSPEC(II))
	ENDDO
	IF(MAXY.EQ.0) MAXY=1

	IF(ROT) THEN
	   IUX0=0
	   IUX1=MAXY
	   IUY0=0
	   IUY1=NCHAN-1
	ELSE
	   IUX0=0
	   IUX1=NCHAN-1
	   IUY0=0
	   IUY1=MAXY
	ENDIF

	XSCA=FLOAT(ITX1-ITX0+1) / FLOAT(IUX1-IUX0+1)
	YSCA=FLOAT(ITY1-ITY0+1) / FLOAT(IUY1-IUY0+1)

	IF(ROT) THEN
	   IF(EXPY.NE.0) XSCA=XSCA*EXPY
	   HIST=ABS(YSCA).GT.1.0
	ELSE
	   IF(EXPY.NE.0) YSCA=YSCA*EXPY
	   HIST=ABS(XSCA).GT.1.0
	ENDIF

	CALL MOVABS(ITX0,ITY0)
	IF(ROT) THEN
	   DO II=0,NCHAN-1
		IUX=LSPEC(II)
		IUY=II
		IX=ITX0 + (IUX-IUX0)*XSCA
		IF(IX.LT.ITXMIN) IX=ITXMIN
		IF(IX.GT.ITXMAX) IX=ITXMAX
		IF(HIST) THEN
		   IY=ITY0 + ((IUY-1)-IUY0)*YSCA
		   IF(IY.LT.ITYMIN) IY=ITYMIN
		   IF(IY.GT.ITYMAX) IY=ITYMAX
		   CALL DRWABS( IX, IY)
		ENDIF
		IY=ITY0 + (IUY-IUY0)*YSCA
		IF(IY.LT.ITYMIN) IY=ITYMIN
		IF(IY.GT.ITYMAX) IY=ITYMAX
		CALL DRWABS( IX, IY)
	   ENDDO
	ELSE
	   DO II=0,NCHAN-1
		IUX=II
		IUY=LSPEC(II)
		IY=ITY0 + (IUY-IUY0)*YSCA
		IF(IY.LT.ITYMIN) IY=ITYMIN
		IF(IY.GT.ITYMAX) IY=ITYMAX
		IF(HIST) THEN
		   IX=ITX0 + ((IUX-1)-IUX0)*XSCA
		   IF(IX.LT.ITXMIN) IX=ITXMIN
		   IF(IX.GT.ITXMAX) IX=ITXMAX
		   CALL DRWABS( IX, IY)
		ENDIF
		IX=ITX0 + (IUX-IUX0)*XSCA
		IF(IX.LT.ITXMIN) IX=ITXMIN
		IF(IX.GT.ITXMAX) IX=ITXMAX
		CALL DRWABS( IX, IY)
	   ENDDO
	ENDIF
	CALL MOVABS(ITX0,ITY0)

	RETURN

	END

	SUBROUTINE DRAW_RSPEC(RSPEC,NCHAN,IX0,IX1,IY0,IY1,IROT,EXPY)

	REAL RSPEC(0:1)

	logical*1 ROT,HIST

	ROT=IROT.NE.0

	ITX0=IX0
	ITX1=IX1
	ITY0=IY0
	ITY1=IY1
	ITXMIN=MIN(ITX0,ITX1)
	ITXMAX=MAX(ITX0,ITX1)
	ITYMIN=MIN(ITY0,ITY1)
	ITYMAX=MAX(ITY0,ITY1)

	CALL MOVABS(ITX0,ITY0)
	CALL DRWABS(ITX1,ITY0)
	CALL DRWABS(ITX1,ITY1)
	CALL DRWABS(ITX0,ITY1)
	CALL DRWABS(ITX0,ITY0)

	RMAXY=0
	DO II=0,NCHAN-1
		RMAXY=MAX(RMAXY,RSPEC(II))
	ENDDO
	IF(RMAXY.EQ.0) RMAXY=1

	IF(ROT) THEN
	   RUX0=0.
	   RUX1=RMAXY
	   RUY0=0
	   RUY1=NCHAN-1
	ELSE
	   RUX0=0
	   RUX1=NCHAN-1
	   RUY0=0.
	   RUY1=RMAXY
	ENDIF

	XSCA=FLOAT(ITX1-ITX0+1) / (RUX1-RUX0+1)
	YSCA=FLOAT(ITY1-ITY0+1) / (RUY1-RUY0+1)

	IF(ROT) THEN
	   IF(EXPY.NE.0) XSCA=XSCA*EXPY
	   HIST=ABS(YSCA).GT.1.0
	ELSE
	   IF(EXPY.NE.0) YSCA=YSCA*EXPY
	   HIST=ABS(XSCA).GT.1.0
	ENDIF

	CALL MOVABS(ITX0,ITY0)
	IF(ROT) THEN
	   DO II=0,NCHAN-1
		RUX=RSPEC(II)
		RUY=II
		IX=ITX0 + (RUX-RUX0)*XSCA
		IF(IX.LT.ITXMIN) IX=ITXMIN
		IF(IX.GT.ITXMAX) IX=ITXMAX
		IF(HIST) THEN
		   IY=ITY0 + ((RUY-1)-RUY0)*YSCA
		   IF(IY.LT.ITYMIN) IY=ITYMIN
		   IF(IY.GT.ITYMAX) IY=ITYMAX
		   CALL DRWABS( IX, IY)
		ENDIF
		IY=ITY0 + (RUY-RUY0)*YSCA
		IF(IY.LT.ITYMIN) IY=ITYMIN
		IF(IY.GT.ITYMAX) IY=ITYMAX
		CALL DRWABS( IX, IY)
	   ENDDO
	ELSE
	   DO II=0,NCHAN-1
		RUX=II
		RUY=RSPEC(II)
		IY=ITY0 + (RUY-RUY0)*YSCA
		IF(IY.LT.ITYMIN) IY=ITYMIN
		IF(IY.GT.ITYMAX) IY=ITYMAX
		IF(HIST) THEN
		   IX=ITX0 + ((RUX-1)-RUX0)*XSCA
		   IF(IX.LT.ITXMIN) IX=ITXMIN
		   IF(IX.GT.ITXMAX) IX=ITXMAX
		   CALL DRWABS( IX, IY)
		ENDIF
		IX=ITX0 + (RUX-RUX0)*XSCA
		IF(IX.LT.ITXMIN) IX=ITXMIN
		IF(IX.GT.ITXMAX) IX=ITXMAX
		CALL DRWABS( IX, IY)
	   ENDDO
	ENDIF
	CALL MOVABS(ITX0,ITY0)

	RETURN

	END
