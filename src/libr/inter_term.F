CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C$+									C
C			GESTIONE TERMINALI				C
C$-									C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

	SUBROUTINE ANSI_BELL(LUN)

C	SPEDISCE UN CARATTERE <BELL> SULL'UNITA' LUN

	ENTRY	   ALFA_BELL(LUN)
	ENTRY	   BELL(LUN)
	ENTRY      BEEP(LUN)

	WRITE(LUN,'(A,$)') 7

	RETURN

	END

	SUBROUTINE SET_LINE_INDEX(ICOLOR,ITERM)

	DATA ICOLORO/-1000/

!	ICOLOR = -1	Bianco
!	ICOLOR < -1	Nero
!
!	ITERM = 1	TEK41xx
!	ITERM = 2	HP2397A

	ICOLORN=ICOLOR

	IF(ITERM.EQ.1) THEN			! TEK4107
		IF(ICOLORN.EQ.-1) ICOLORN=1
		IF(ICOLORN.LT.0)  ICOLORN=0
		ICOLORN=MOD(ICOLORN,16)
		IF(ICOLORN.NE.ICOLORO) CALL SET_LINE_INDEX_TEK(ICOLORN)
		ICOLORO=ICOLORN
	ELSE IF(ITERM.EQ.2) THEN		! HP2397A
		IF(ICOLORN.EQ.-1) ICOLORN=7
		IF(ICOLORN.LT.0)  ICOLORN=0
		ICOLORN=MOD(ICOLORN,8)
		IF(ICOLORN.NE.ICOLORO) CALL SET_LINE_INDEX_HP(ICOLORN)
		ICOLORO=ICOLORN
	ENDIF

	RETURN

	END

	SUBROUTINE SET_LINE_INDEX_TEK(II)

C		SETTA I COLORI SU TEK4107A

	JJ=MOD(II,16)

	CALL TOUTPC(3)
	CALL TOUTPC(27)		! ESC
	CALL TOUTPC(77)		! M
	CALL TOUTPC(76)		! L
	CALL TOUTPC(JJ+48)	! COLOR#

	RETURN

	END

	SUBROUTINE SET_LINE_INDEX_HP(II)

C		SETTA I COLORI SU HP2397A

	JJ=MOD(II,8)

	CALL TOUTPC(31)		! ANMODE
	CALL TOUTPC(27)		! ESC
	CALL TOUTPC(42)		! *
	CALL TOUTPC(109)	! m
	CALL TOUTPC(JJ+48)	! COLOR#
	CALL TOUTPC(88)		! X

	RETURN

	END

	SUBROUTINE SET_DRAW_MODE(II,ITERM)

C	II=1	==> SET
C	II=2	==> XOR

	IF(ITERM.EQ.1) CALL SET_DRAW_MODE_TEK(II)
	IF(ITERM.EQ.2) CALL SET_DRAW_MODE_HP(II)

	RETURN

	END

	SUBROUTINE SET_DRAW_MODE_TEK(II)

C	SETTA IL MODO DI TRACCIARE SU TEK4107A
C		II=1	==> SET
C		II=2	==> XOR

	JJ=1
	IF(II.EQ.2) JJ=2

	CALL TOUTPC(27)		! ESC
	CALL TOUTPC(83)		! S
	CALL TOUTPC(77)		! M
	CALL TOUTPC(34)		! " -2 ALL SEG.
	CALL TOUTPC(JJ+48)	! MODE

	RETURN

	END

	SUBROUTINE SET_DRAW_MODE_HP(II)

C	SETTA IL MODO DI TRACCIARE SU  HP2397A
C		II=1	==> SET
C		II=2	==> XOR

	JJ=2
	IF(II.EQ.2) JJ=6

	CALL TOUTPC(31)		! ANMODE
	CALL TOUTPC(27)		! ESC
	CALL TOUTPC(42)		! *
	CALL TOUTPC(109)	! m
	CALL TOUTPC(JJ+48)	! MODE
	CALL TOUTPC(65)		! X

	RETURN

	END

	SUBROUTINE SET_DRAW_MODE_HIREZ(II)

C	SETTA IL MODO DI TRACCIARE SU HIREZ_100
C		II=1	SET
C		II=2	XOR
C		II=3	DEL

	CALL TOUTPC(27)
	CALL TOUTPC(79)
	CALL TOUTPC(87)
	CALL TOUTPC(32)
	CALL TOUTPC(II+95)
	CALL TOUTPC(96)
	CALL TOUTPC(32)
	CALL TOUTPC(64)
	CALL TOUTPC(64)

	RETURN

	END
